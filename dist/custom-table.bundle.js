var CustomTable=function(o,n){"use strict";var m=Object.defineProperty;var p=(o,n,c)=>n in o?m(o,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[n]=c;var h=(o,n,c)=>p(o,typeof n!="symbol"?n+"":n,c);class c{constructor(e){this.mount=e.mount,this.fields=e.fields,this.pageSize=e.pageSize||20,this.renderRow=e.renderRow,this.renderPagination=e.renderPagination,this.currentPage=1,this.currentSort={field:null,order:"asc"},this.records=[],this.sortedRecords=[],this.table=null}init(){this.createTableShell()}setData(e){this.records=e||[],this.sortedRecords=[...this.records],this.renderPage(1)}createTableShell(){this.table=document.createElement("table"),this.table.className="custom-table";const e=document.createElement("thead"),t=document.createElement("tr"),s=document.createElement("th");s.innerText="詳細",s.style.width="35px",t.appendChild(s),this.fields.forEach(a=>{const r=document.createElement("th");r.innerHTML=a.label.replace(/[(（]/g,"<br>$&"),r.dataset.fieldCode=a.code,r.classList.add("sortable"),r.onclick=()=>this.sortByField(a.code),t.appendChild(r)});const i=document.createElement("th");i.innerText="編集",t.appendChild(i),e.appendChild(t),this.table.appendChild(e),this.mount.innerHTML="",this.mount.appendChild(this.table)}sortByField(e){this.currentSort.field===e?this.currentSort.order=this.currentSort.order==="asc"?"desc":"asc":(this.currentSort.field=e,this.currentSort.order="asc"),this.sortedRecords.sort((t,s)=>{var r,d;const i=((r=t[e])==null?void 0:r.value)??"",a=((d=s[e])==null?void 0:d.value)??"";return this.currentSort.order==="asc"?String(i).localeCompare(String(a)):String(a).localeCompare(String(i))}),this.renderPage(1)}renderPage(e){const t=this.sortedRecords.length,s=Math.ceil(t/this.pageSize);this.currentPage=Math.min(Math.max(1,e),s||1);const i=(this.currentPage-1)*this.pageSize,a=i+this.pageSize,r=this.sortedRecords.slice(i,a);this.renderBody(r),this.renderPagination&&this.renderPagination({total:t,totalPages:s,currentPage:this.currentPage,onChange:d=>this.renderPage(d)})}renderBody(e){let t=this.table.querySelector("tbody");t&&t.remove(),t=document.createElement("tbody"),e.forEach(s=>{const i=document.createElement("tr");this.renderRow(i,s,this.table),t.appendChild(i)}),this.table.appendChild(t)}}class l extends n.LitElement{constructor(){super(),this.fields=[],this.records=[],this.pageSize=20,this.tableCore=null}render(){return n.html`
      <div id="table-root"></div>
      <div id="pagination-root"></div>
    `}firstUpdated(){const e=this.renderRoot.querySelector("#table-root"),t=this.renderRoot.querySelector("#pagination-root");this.tableCore=new c({mount:e,fields:this.fields,pageSize:this.pageSize,renderRow:window.renderRowContents,renderPagination:({totalPages:s,currentPage:i,onChange:a})=>{t.innerHTML="";for(let r=1;r<=s;r++){const d=document.createElement("button");d.innerText=r,r===i&&(d.disabled=!0),d.onclick=()=>a(r),t.appendChild(d)}}}),this.tableCore.init(),this.tableCore.setData(this.records)}updated(e){e.has("records")&&this.tableCore&&this.tableCore.setData(this.records)}}return h(l,"properties",{fields:{type:Array},records:{type:Array},pageSize:{type:Number}}),customElements.define("custom-table",l),o.CustomTable=l,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),o}({},index_js_module);
